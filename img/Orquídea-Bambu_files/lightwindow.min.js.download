function lightwindowInit(){myLightWindow=new lightwindow}if("undefined"==typeof Effect)throw"lightwindow.js requires including script.aculo.us' effects.js library!";try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}var lightwindow=Class.create();lightwindow.prototype={element:null,contentToFetch:null,windowActive:!1,dataEffects:[],dimensions:{cruft:null,container:null,viewport:{height:null,width:null,offsetTop:null,offsetLeft:null}},pagePosition:{x:0,y:0},pageDimensions:{width:null,height:null},preloadImage:[],preloadedImage:[],galleries:[],resizeTo:{height:null,heightPercent:null,width:null,widthPercent:null,fixedTop:null,fixedLeft:null},scrollbarOffset:18,navigationObservers:{previous:null,next:null},containerChange:{height:0,width:0},activeGallery:!1,galleryLocation:{current:0,total:0},initialize:function(i){this.options=Object.extend({resizeSpeed:8,contentOffset:{height:20,width:20},dimensions:{image:{height:250,width:250},page:{height:250,width:250},inline:{height:250,width:250},media:{height:250,width:250},external:{height:250,width:250},titleHeight:25},classNames:{standard:"lightwindow",action:"lightwindow_action"},fileTypes:{page:["asp","aspx","cgi","","cfm","htm","html","pl","php4","php3","php","php5","phtml","rhtml","shtml","txt","vbs","rb"],media:["aif","aiff","asf","avi","divx","m1v","m2a","m2v","m3u","mid","midi","mov","moov","movie","mp2","mp3","mpa","mpa","mpe","mpeg","mpg","mpg","mpga","pps","qt","rm","ram","swf","viv","vivo","wav"],image:["bmp","gif","jpg","png","tiff"]},mimeTypes:{avi:"video/avi",aif:"audio/aiff",aiff:"audio/aiff",gif:"image/gif",bmp:"image/bmp",jpeg:"image/jpeg",m1v:"video/mpeg",m2a:"audio/mpeg",m2v:"video/mpeg",m3u:"audio/x-mpequrl",mid:"audio/x-midi",midi:"audio/x-midi",mjpg:"video/x-motion-jpeg",moov:"video/quicktime",mov:"video/quicktime",movie:"video/x-sgi-movie",mp2:"audio/mpeg",mp3:"audio/mpeg3",mpa:"audio/mpeg",mpa:"video/mpeg",mpe:"video/mpeg",mpeg:"video/mpeg",mpg:"audio/mpeg",mpg:"video/mpeg",mpga:"audio/mpeg",pdf:"application/pdf",png:"image/png",pps:"application/mspowerpoint",qt:"video/quicktime",ram:"audio/x-pn-realaudio-plugin",rm:"application/vnd.rn-realmedia",swf:"application/x-shockwave-flash",tiff:"image/tiff",viv:"video/vivo",vivo:"video/vivo",wav:"audio/wav",wmv:"application/x-mplayer2"},classids:{mov:"clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B",swf:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",wmv:"clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6"},codebases:{mov:"http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0",swf:"http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0",wmv:"http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=6,4,5,715"},viewportPadding:10,EOLASFix:"swf,wmv,fla,flv",overlay:{opacity:.7,image:"/assets/store/img/black.png",presetImage:"/assets/store/img/black-70.png"},skin:{main:'<div id="lightwindow_container" ><div id="lightwindow_title_bar" ><div id="lightwindow_title_bar_inner" ><span id="lightwindow_title_bar_title"></span><a id="lightwindow_title_bar_close_link" ><img src="/assets/store/img/fechar.png"/></a></div></div><div id="lightwindow_stage" ><div id="lightwindow_contents" ></div><div id="lightwindow_navigation" ><a href="#" id="lightwindow_previous" ><span id="lightwindow_previous_title"></span></a><a href="#" id="lightwindow_next" ><span id="lightwindow_next_title"></span></a><iframe name="lightwindow_navigation_shim" id="lightwindow_navigation_shim" src="javascript:false;" frameBorder="0" scrolling="no"></iframe></div><div id="lightwindow_galleries"><div id="lightwindow_galleries_tab_container" ><a href="#" id="lightwindow_galleries_tab" ><span id="lightwindow_galleries_tab_span" class="up" ></span></a></div><div id="lightwindow_galleries_list" ></div></div></div><div id="lightwindow_data_slide" ><div id="lightwindow_data_slide_inner" ><div id="lightwindow_data_details" ><div id="lightwindow_data_gallery_container" ><span id="lightwindow_data_gallery_current"></span>&nbsp;de&nbsp;<span id="lightwindow_data_gallery_total"></span></div><div id="lightwindow_data_author_container" >by <span id="lightwindow_data_author"></span></div></div><div id="lightwindow_data_caption" ></div></div></div></div>',loading:'<div id="lightwindow_loading" ><img src="/assets/store/img/ajax-loading.gif" alt="Carregando" /><span>Carregando... &nbsp; | &nbsp; <a href="javascript: myLightWindow.deactivate();">Cancelar</a></span><iframe name="lightwindow_loading_shim" id="lightwindow_loading_shim" src="javascript:false;" frameBorder="0" scrolling="no"></iframe></div>',iframe:'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"><body>{body_replace}</body></html>',gallery:{top:'<div class="lightwindow_galleries_list"><h1>{gallery_title_replace}</h1><ul>',middle:"<li>{gallery_link_replace}</li>",bottom:"</ul></div>"}},formMethod:"get",hideFlash:!1,hideGalleryTab:!1,showTitleBar:!0,animationHandler:!1,navigationHandler:!1,transitionHandler:!1,finalAnimationHandler:!1,formHandler:!1,galleryAnimationHandler:!1,showGalleryCount:!0},i||{}),this.duration=.15*(11-this.options.resizeSpeed),this._setupLinks(),this._getScroll(),this._getPageDimensions(),this._browserDimensions(),this._addLightWindowMarkup(!1),this._setupDimensions(),this.buildGalleryList()},activate:function(i,t){this._clearWindowContents(!0),this._addLoadingWindowMarkup(),this._setupWindowElements(t),this._getScroll(),this._browserDimensions(),this._setupDimensions(),this._toggleTroubleElements("hidden",!1),this._displayLightWindow("block","hidden"),this._setStatus(!0),this._monitorKeyboard(!0),this._prepareIE(!0),this._loadWindow()},deactivate:function(){this.windowActive=!1,this.activeGallery=!1,this.options.hideGalleryTab||this._handleGalleryAnimation(!1),this.animating=!1,this.element=null,this._displayLightWindow("none","visible"),this._clearWindowContents(!1);Effect.Queues.get("lightwindowAnimation").each(function(i){i.cancel()});this._prepareIE(!1),this._setupDimensions(),this._toggleTroubleElements("visible",!1),this._monitorKeyboard(!1)},createWindow:function(i){this._processLink($(i))},activateWindow:function(i){this.element=Object.extend({href:null,title:null,author:null,caption:null,rel:null,top:null,left:null,type:null,showImages:null,height:null,width:null,loadingAnimation:null,iframeEmbed:null,form:null,iframeNome:null},i||{}),this.contentToFetch=this.element.href,this.windowType=this.element.type?this.element.type:this._fileType(this.element.href),this.iframeNome=this.element.iframeNome?this.element.iframeNome:"lightwindow_iframe",this._clearWindowContents(!0),this._addLoadingWindowMarkup(),this._getScroll(),this._browserDimensions(),this._setupDimensions(),this._toggleTroubleElements("hidden",!1),this._displayLightWindow("block","hidden"),this._setStatus(!0),this._monitorKeyboard(!0),this._prepareIE(!0),this._loadWindow()},submitForm:function(i){this.options.formHandler?this.options.formHandler(i):this._defaultFormHandler(i)},openWindow:function(i){var i=$(i);this.windowActive=!0,this._clearWindowContents(!0),this._addLoadingWindowMarkup(),this._setupWindowElements(i),this._setStatus(!0),this._handleTransition()},navigateWindow:function(i){this._handleNavigation(!1),"previous"==i?this.openWindow(this.navigationObservers.previous):"next"==i&&this.openWindow(this.navigationObservers.next)},buildGalleryList:function(){var t,e="";for(i in this.galleries)if("object"==typeof this.galleries[i]){e+=this.options.skin.gallery.top.replace("{gallery_title_replace}",unescape(i));for(j in this.galleries[i])"object"==typeof this.galleries[i][j]&&(t='<a href="#" id="lightwindow_gallery_'+i+"_"+j+'" >'+unescape(j)+"</a>",e+=this.options.skin.gallery.middle.replace("{gallery_link_replace}",t));e+=this.options.skin.gallery.bottom}new Insertion.Top("lightwindow_galleries_list",e);for(i in this.galleries)if("object"==typeof this.galleries[i])for(j in this.galleries[i])"object"==typeof this.galleries[i][j]&&(Event.observe($("lightwindow_gallery_"+i+"_"+j),"click",this.openWindow.bind(this,this.galleries[i][j][0]),!1),$("lightwindow_gallery_"+i+"_"+j).onclick=function(){return!1})},_setupLinks:function(){var i=$$("."+this.options.classNames.standard);i.each(function(i){this._processLink(i)}.bind(this))},_processLink:function(i){("image"==this._fileType(i.getAttribute("href"))||"media"==this._fileType(i.getAttribute("href")))&&(gallery=this._getGalleryInfo(i.rel))&&(this.galleries[gallery[0]]||(this.galleries[gallery[0]]=new Array),this.galleries[gallery[0]][gallery[1]]||(this.galleries[gallery[0]][gallery[1]]=new Array),this.galleries[gallery[0]][gallery[1]].push(i));var t=i.getAttribute("href");t.indexOf("?")>-1&&(t=t.substring(0,t.indexOf("?")));var e=t.substring(t.indexOf("#")+1);$(e)&&$(e).setStyle({display:"none"}),Event.observe(i,"click",this.activate.bindAsEventListener(this,i),!1),i.onclick=function(){return!1}},_setupActions:function(){var i=$$("#lightwindow_container ."+this.options.classNames.action);i.each(function(i){Event.observe(i,"click",this[i.getAttribute("rel")].bindAsEventListener(this,i),!1),i.onclick=function(){return!1}}.bind(this))},_addLightWindowMarkup:function(){var i=Element.extend(document.createElement("div"));i.setAttribute("id","lightwindow_overlay"),i.setStyle(Prototype.Browser.Gecko?{backgroundImage:"url("+this.options.overlay.presetImage+")",backgroundRepeat:"repeat",height:2500+this.pageDimensions.height+"px"}:{opacity:this.options.overlay.opacity,backgroundImage:"url("+this.options.overlay.image+")",backgroundRepeat:"repeat",height:2500+this.pageDimensions.height+"px"});var t=document.createElement("div");t.setAttribute("id","lightwindow"),t.innerHTML=this.options.skin.main;var e=document.getElementsByTagName("body")[0];e.appendChild(i),e.appendChild(t),$("lightwindow_title_bar_close_link")&&(Event.observe("lightwindow_title_bar_close_link","click",this.deactivate.bindAsEventListener(this)),$("lightwindow_title_bar_close_link").onclick=function(){return!1}),Event.observe($("lightwindow_previous"),"click",this.navigateWindow.bind(this,"previous"),!1),$("lightwindow_previous").onclick=function(){return!1},Event.observe($("lightwindow_next"),"click",this.navigateWindow.bind(this,"next"),!1),$("lightwindow_next").onclick=function(){return!1},this.options.hideGalleryTab||(Event.observe($("lightwindow_galleries_tab"),"click",this._handleGalleryAnimation.bind(this,!0),!1),$("lightwindow_galleries_tab").onclick=function(){return!1}),Prototype.Browser.IE?Event.observe(document,"mousewheel",this._stopScrolling.bindAsEventListener(this),!1):Event.observe(window,"DOMMouseScroll",this._stopScrolling.bindAsEventListener(this),!1),Event.observe(i,"click",this.deactivate.bindAsEventListener(this),!1),i.onclick=function(){return!1}},_addLoadingWindowMarkup:function(){$("lightwindow_contents").innerHTML+=this.options.skin.loading},_setupWindowElements:function(i){this.element=i,this.element.title=i.getAttribute("title"),this.element.author=i.getAttribute("author"),this.element.caption=i.getAttribute("caption"),this.element.rel=i.getAttribute("rel"),this.element.params=i.getAttribute("params"),this.contentToFetch=this.element.href,this.windowType=this._getParameter("lightwindow_type")?this._getParameter("lightwindow_type"):this._fileType(this.contentToFetch)},_clearWindowContents:function(i){if($(this.iframeNome)&&Element.remove($(this.iframeNome)),$("lightwindow_media_primary")){try{$("lightwindow_media_primary").Stop()}catch(t){}Element.remove($("lightwindow_media_primary"))}if($("lightwindow_media_secondary")){try{$("lightwindow_media_secondary").Stop()}catch(t){}Element.remove($("lightwindow_media_secondary"))}this.activeGallery=!1,this._handleNavigation(this.activeGallery),i&&($("lightwindow_contents").innerHTML="",$("lightwindow_contents").setStyle({overflow:"hidden"}),this.windowActive||($("lightwindow_data_slide_inner").setStyle({display:"none"}),$("lightwindow_title_bar_title").innerHTML=""),$("lightwindow_data_slide").setStyle({height:"auto"})),this.resizeTo.height=null,this.resizeTo.width=null},_setStatus:function(i){this.animating=i,i&&Element.show("lightwindow_loading"),/MSIE 6./i.test(navigator.userAgent)||this._fixedWindow(i)},_fixedWindow:function(i){i?this.windowActive?(this._getScroll(),$("lightwindow").setStyle({position:"absolute",top:parseFloat($("lightwindow").getStyle("top"))+this.pagePosition.y+"px",left:parseFloat($("lightwindow").getStyle("left"))+this.pagePosition.x+"px"})):$("lightwindow").setStyle({position:"absolute"}):this.windowActive?(this._getScroll(),$("lightwindow").setStyle({position:"fixed",top:parseFloat($("lightwindow").getStyle("top"))-this.pagePosition.y+"px",left:parseFloat($("lightwindow").getStyle("left"))-this.pagePosition.x+"px"})):($(this.iframeNome)&&this._browserDimensions(),$("lightwindow").setStyle({position:"fixed",top:parseFloat(this._getParameter("lightwindow_top"))?parseFloat(this._getParameter("lightwindow_top"))+"px":this.dimensions.viewport.height/2+"px",left:parseFloat(this._getParameter("lightwindow_left"))?parseFloat(this._getParameter("lightwindow_left"))+"px":this.dimensions.viewport.width/2+"px"}))},_prepareIE:function(i){if(Prototype.Browser.IE){var t;if(i)var t="100%";else var t="auto";var e=document.getElementsByTagName("body")[0],n=document.getElementsByTagName("html")[0];n.style.height=e.style.height=t}},_stopScrolling:function(i){this.animating&&(i.preventDefault&&i.preventDefault(),i.returnValue=!1)},_getScroll:function(){"number"==typeof window.pageYOffset?(this.pagePosition.x=window.pageXOffset,this.pagePosition.y=window.pageYOffset):document.body&&(document.body.scrollLeft||document.body.scrollTop)?(this.pagePosition.x=document.body.scrollLeft,this.pagePosition.y=document.body.scrollTop):document.documentElement&&(this.pagePosition.x=document.documentElement.scrollLeft,this.pagePosition.y=document.documentElement.scrollTop)},_setScroll:function(i,t){document.documentElement.scrollLeft=i,document.documentElement.scrollTop=t},_toggleTroubleElements:function(i,t){if(t)var e=$("lightwindow_contents").getElementsByTagName("select");else var e=document.getElementsByTagName("select");for(var n=0;n<e.length;n++)e[n].style.visibility=i;if(!t){if(this.options.hideFlash){var o=document.getElementsByTagName("object");for(n=0;n!=o.length;n++)o[n].style.visibility=i;var s=document.getElementsByTagName("embed");for(n=0;n!=s.length;n++)s[n].style.visibility=i}var a=document.getElementsByTagName("iframe");for(n=0;n!=a.length;n++)a[n].style.visibility=i}},_getPageDimensions:function(){var i,t;window.innerHeight&&window.scrollMaxY?(i=document.body.scrollWidth,t=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(i=document.body.scrollWidth,t=document.body.scrollHeight):(i=document.body.offsetWidth,t=document.body.offsetHeight);var e,n;self.innerHeight?(e=self.innerWidth,n=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(e=document.documentElement.clientWidth,n=document.documentElement.clientHeight):document.body&&(e=document.body.clientWidth,n=document.body.clientHeight),this.pageDimensions.height=n>t?n:t,this.pageDimensions.width=e>i?e:i},_displayLightWindow:function(i,t){$("lightwindow_overlay").style.display=$("lightwindow").style.display=$("lightwindow_container").style.display=i,$("lightwindow_overlay").style.visibility=$("lightwindow").style.visibility=$("lightwindow_container").style.visibility=t},_setupDimensions:function(){var i,t;switch(this.windowType){case"page":i=this.options.dimensions.page.height,t=this.options.dimensions.page.width;break;case"image":i=this.options.dimensions.image.height,t=this.options.dimensions.image.width;break;case"media":i=this.options.dimensions.media.height,t=this.options.dimensions.media.width;break;case"external":i=this.options.dimensions.external.height,t=this.options.dimensions.external.width;break;case"inline":i=this.options.dimensions.inline.height,t=this.options.dimensions.inline.width;break;default:i=this.options.dimensions.page.height,t=this.options.dimensions.page.width}var e=this._getParameter("lightwindow_top")?parseFloat(this._getParameter("lightwindow_top"))+this.pagePosition.y:this.dimensions.viewport.height/2+this.pagePosition.y,n=this._getParameter("lightwindow_left")?parseFloat(this._getParameter("lightwindow_left"))+this.pagePosition.x:this.dimensions.viewport.width/2+this.pagePosition.x;$("lightwindow").setStyle({top:e+"px",left:n+"px"}),$("lightwindow_container").setStyle({height:i+"px",width:t+"px",left:-(t/2)+"px",top:-(i/2)+"px"}),$("lightwindow_contents").setStyle({height:i+"px",width:t+"px"})},_fileType:function(i){var t=new RegExp("[^.].("+this.options.fileTypes.image.join("|")+")s*$","i");if(t.test(i))return"image";if(i.indexOf("#")>-1&&document.domain==this._getDomain(i))return"inline";i.indexOf("?")>-1&&(i=i.substring(0,i.indexOf("?")));var e="unknown",n=new RegExp("[^.].("+this.options.fileTypes.page.join("|")+")s*$","i"),o=new RegExp("[^.].("+this.options.fileTypes.media.join("|")+")s*$","i");return document.domain!=this._getDomain(i)&&(e="external"),o.test(i)&&(e="media"),"external"==e||"media"==e?e:((n.test(i)||"/"==i.substr(i.length-1,i.length))&&(e="page"),e)},_fileExtension:function(i){i.indexOf("?")>-1&&(i=i.substring(0,i.indexOf("?")));for(var t="",e=i.length-1;e>-1;e--){if("."==i.charAt(e))return t;t=i.charAt(e)+t}},_monitorKeyboard:function(i){document.onkeydown=i?this._eventKeypress.bind(this):""},_eventKeypress:function(i){if(null==i)var t=event.keyCode;else var t=i.which;switch(t){case 27:this.deactivate();break;case 13:return}if(this.animating)return!1;switch(String.fromCharCode(t).toLowerCase()){case"p":this.navigationObservers.previous&&this.navigateWindow("previous");break;case"n":this.navigationObservers.next&&this.navigateWindow("next")}},_getGalleryInfo:function(i){return i&&i.indexOf("[")>-1?new Array(escape(i.substring(0,i.indexOf("["))),escape(i.substring(i.indexOf("[")+1,i.indexOf("]")))):!1},_getDomain:function(i){var t=i.indexOf("//"),e=t+2,n=i.substring(e,i.length),o=n.indexOf("/"),s=n.substring(0,o);if(s.indexOf(":")>-1){var a=s.indexOf(":");s=s.substring(0,a)}return s},_getParameter:function(i,t){if(!this.element)return!1;if("lightwindow_top"==i&&this.element.top)return unescape(this.element.top);if("lightwindow_left"==i&&this.element.left)return unescape(this.element.left);if("lightwindow_type"==i&&this.element.type)return unescape(this.element.type);if("lightwindow_show_images"==i&&this.element.showImages)return unescape(this.element.showImages);if("lightwindow_height"==i&&this.element.height)return unescape(this.element.height);if("lightwindow_width"==i&&this.element.width)return unescape(this.element.width);if("lightwindow_loading_animation"==i&&this.element.loadingAnimation)return unescape(this.element.loadingAnimation);if("lightwindow_iframe_embed"==i&&this.element.iframeEmbed)return unescape(this.element.iframeEmbed);if("lightwindow_form"==i&&this.element.form)return unescape(this.element.form);if(!t){if(!this.element.params)return;t=this.element.params}for(var e,n=t.split(","),o=i+"=",s=o.length,a=0;a<n.length;a++)if(n[a].substr(0,s)==o){var l=n[a].split("=");e=l[1];break}return e?unescape(e):!1},_browserDimensions:function(){Prototype.Browser.IE?(this.dimensions.viewport.height=document.documentElement.clientHeight,this.dimensions.viewport.width=document.documentElement.clientWidth):(this.dimensions.viewport.height=window.innerHeight,this.dimensions.viewport.width=document.width||document.body.offsetWidth)},_getScrollerWidth:function(){var i=Element.extend(document.createElement("div"));i.setAttribute("id","lightwindow_scroll_div"),i.setStyle({position:"absolute",top:"-10000px",left:"-10000px",width:"100px",height:"100px",overflow:"hidden"});var t=Element.extend(document.createElement("div"));t.setAttribute("id","lightwindow_content_scroll_div"),t.setStyle({width:"100%",height:"200px"}),i.appendChild(t);var e=document.getElementsByTagName("body")[0];e.appendChild(i);var n=$("lightwindow_content_scroll_div").offsetWidth;i.style.overflow="auto";var o=$("lightwindow_content_scroll_div").offsetWidth;Element.remove($("lightwindow_scroll_div")),this.scrollbarOffset=n-o},_addParamToObject:function(i,t,e,n){var o=document.createElement("param");return o.setAttribute("value",t),o.setAttribute("name",i),n&&o.setAttribute("id",n),e.appendChild(o),e},_outerHTML:function(i){if(Prototype.Browser.IE)return i.outerHTML;var t=i.cloneNode(!0),e=document.createElement("div");return e.appendChild(t),e.innerHTML},_convertToMarkup:function(i,t){var e=this._outerHTML(i).replace("</"+t+">","");if(Prototype.Browser.IE){for(var n=0;n<i.childNodes.length;n++)e+=this._outerHTML(i.childNodes[n]);e+="</"+t+">"}return e},_appendObject:function(i,t,e){if(Prototype.Browser.IE){if(e.innerHTML+=this._convertToMarkup(i,t),this.options.EOLASFix.indexOf(this._fileType(this.element.href))>-1)for(var n=document.getElementsByTagName("object"),o=0;o<n.length;o++)n[o].getAttribute("data")&&n[o].removeAttribute("data"),n[o].outerHTML=n[o].outerHTML,n[o].style.visibility="visible"}else e.appendChild(i)},_appendIframe:function(i){var t=document.createElement("iframe");t.setAttribute("id",this.iframeNome),t.setAttribute("name",this.iframeNome),t.setAttribute("src","about:blank"),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("frameborder","0"),t.setAttribute("marginwidth","0"),t.setAttribute("marginheight","0"),t.setAttribute("scrolling",i),this._appendObject(t,"iframe",$("lightwindow_contents"))},_writeToIframe:function(i){var t=this.options.skin.iframe;t=t.replace("{body_replace}",i),$(this.iframeNome).contentWindow?($(this.iframeNome).contentWindow.document.open(),$(this.iframeNome).contentWindow.document.write(t),$(this.iframeNome).contentWindow.document.close()):($(this.iframeNome).contentDocument.open(),$(this.iframeNome).contentDocument.write(t),$(this.iframeNome).contentDocument.close())},_loadWindow:function(){switch(this.windowType){case"image":var i=0,t=[];if(this.checkImage=[],this.resizeTo.height=this.resizeTo.width=0,this.imageCount=this._getParameter("lightwindow_show_images")?parseInt(this._getParameter("lightwindow_show_images")):1,gallery=this._getGalleryInfo(this.element.rel)){for(i=0;i<this.galleries[gallery[0]][gallery[1]].length&&!(this.contentToFetch.indexOf(this.galleries[gallery[0]][gallery[1]][i].href)>-1);i++);this.navigationObservers.previous=this.galleries[gallery[0]][gallery[1]][i-this.imageCount]?this.galleries[gallery[0]][gallery[1]][i-this.imageCount]:!1,this.navigationObservers.next=this.galleries[gallery[0]][gallery[1]][i+this.imageCount]?this.galleries[gallery[0]][gallery[1]][i+this.imageCount]:!1,this.activeGallery=!0}else this.navigationObservers.previous=!1,this.navigationObservers.next=!1,this.activeGallery=!1;for(var e=i;e<i+this.imageCount;e++)gallery&&this.galleries[gallery[0]][gallery[1]][e]&&(this.contentToFetch=this.galleries[gallery[0]][gallery[1]][e].href,this.galleryLocation={current:(e+1)/this.imageCount,total:this.galleries[gallery[0]][gallery[1]].length/this.imageCount},this.galleries[gallery[0]][gallery[1]][e+this.imageCount]?($("lightwindow_next").setStyle({display:"block"}),$("lightwindow_next_title").innerHTML=this.galleries[gallery[0]][gallery[1]][e+this.imageCount].title):$("lightwindow_next").setStyle({display:"none"}),this.galleries[gallery[0]][gallery[1]][e-this.imageCount]?($("lightwindow_previous").setStyle({display:"block"}),$("lightwindow_previous_title").innerHTML=this.galleries[gallery[0]][gallery[1]][e-this.imageCount].title):$("lightwindow_previous").setStyle({display:"none"})),t[e]=document.createElement("img"),t[e].setAttribute("id","lightwindow_image_"+e),t[e].setAttribute("border","0"),t[e].setAttribute("src",this.contentToFetch),$("lightwindow_contents").appendChild(t[e]),this.checkImage[e]=new PeriodicalExecuter(function(i){if("undefined"==typeof $("lightwindow_image_"+i).naturalWidth||0!=$("lightwindow_image_"+i).naturalWidth){this.checkImage[i].stop();var t=$("lightwindow_image_"+i).getHeight();t>this.resizeTo.height&&(this.resizeTo.height=t),this.resizeTo.width+=$("lightwindow_image_"+i).getWidth(),this.imageCount--,$("lightwindow_image_"+i).setStyle({height:"100%"}),0==this.imageCount&&this._processWindow()}}.bind(this,e),1);break;case"media":var i=0;if(this.resizeTo.height=this.resizeTo.width=0,gallery=this._getGalleryInfo(this.element.rel)){for(i=0;i<this.galleries[gallery[0]][gallery[1]].length&&!(this.contentToFetch.indexOf(this.galleries[gallery[0]][gallery[1]][i].href)>-1);i++);this.navigationObservers.previous=this.galleries[gallery[0]][gallery[1]][i-1]?this.galleries[gallery[0]][gallery[1]][i-1]:!1,this.navigationObservers.next=this.galleries[gallery[0]][gallery[1]][i+1]?this.galleries[gallery[0]][gallery[1]][i+1]:!1,this.activeGallery=!0}else this.navigationObservers.previous=!1,this.navigationObservers.next=!1,this.activeGallery=!1;gallery&&this.galleries[gallery[0]][gallery[1]][i]&&(this.contentToFetch=this.galleries[gallery[0]][gallery[1]][i].href,this.galleryLocation={current:i+1,total:this.galleries[gallery[0]][gallery[1]].length},this.galleries[gallery[0]][gallery[1]][i+1]?($("lightwindow_next").setStyle({display:"block"}),$("lightwindow_next_title").innerHTML=this.galleries[gallery[0]][gallery[1]][i+1].title):$("lightwindow_next").setStyle({display:"none"}),this.galleries[gallery[0]][gallery[1]][i-1]?($("lightwindow_previous").setStyle({display:"block"}),$("lightwindow_previous_title").innerHTML=this.galleries[gallery[0]][gallery[1]][i-1].title):$("lightwindow_previous").setStyle({display:"none"})),this._getParameter("lightwindow_iframe_embed")?(this.resizeTo.height=this.dimensions.viewport.height,this.resizeTo.width=this.dimensions.viewport.width):(this.resizeTo.height=this._getParameter("lightwindow_height"),this.resizeTo.width=this._getParameter("lightwindow_width")),this._processWindow();break;case"external":this._appendIframe("auto"),this.resizeTo.height=this.dimensions.viewport.height,this.resizeTo.width=this.dimensions.viewport.width,this._processWindow();break;case"page":{new Ajax.Request(this.contentToFetch,{method:"get",parameters:"",onComplete:function(i){$("lightwindow_contents").innerHTML+=i.responseText,this.resizeTo.height=$("lightwindow_contents").scrollHeight+this.options.contentOffset.height,this.resizeTo.width=$("lightwindow_contents").scrollWidth+this.options.contentOffset.width,this._processWindow()}.bind(this)})}break;case"inline":var n=this.contentToFetch;n.indexOf("?")>-1&&(n=n.substring(0,n.indexOf("?"))),n=n.substring(n.indexOf("#")+1),new Insertion.Top($("lightwindow_contents"),$(n).innerHTML),this.resizeTo.height=$("lightwindow_contents").scrollHeight+this.options.contentOffset.height,this.resizeTo.width=$("lightwindow_contents").scrollWidth+this.options.contentOffset.width,this._toggleTroubleElements("hidden",!0),this._processWindow();break;default:throw"Page Type could not be determined, please amend this lightwindow URL "+this.contentToFetch}},_resizeWindowToFit:function(){if(this.resizeTo.height+this.dimensions.cruft.height>this.dimensions.viewport.height){var i=this.resizeTo.height/this.resizeTo.width;this.resizeTo.height=this.dimensions.viewport.height-this.dimensions.cruft.height-2*this.options.viewportPadding,("image"==this.windowType||"media"==this.windowType&&!this._getParameter("lightwindow_iframe_embed"))&&(this.resizeTo.width=this.resizeTo.height/i,$("lightwindow_data_slide_inner").setStyle({width:this.resizeTo.width+"px"}))}if(this.resizeTo.width+this.dimensions.cruft.width>this.dimensions.viewport.width){var t=this.resizeTo.width/this.resizeTo.height;this.resizeTo.width=this.dimensions.viewport.width-2*this.dimensions.cruft.width-2*this.options.viewportPadding,("image"==this.windowType||"media"==this.windowType&&!this._getParameter("lightwindow_iframe_embed"))&&(this.resizeTo.height=this.resizeTo.width/t,$("lightwindow_data_slide_inner").setStyle({height:this.resizeTo.height+"px"}))}},_presetWindowSize:function(){this._getParameter("lightwindow_height")&&(this.resizeTo.height=parseFloat(this._getParameter("lightwindow_height"))),this._getParameter("lightwindow_width")&&(this.resizeTo.width=parseFloat(this._getParameter("lightwindow_width")))},_processWindow:function(){this.dimensions.dataEffects=[],this.element.caption||this.element.author||this.activeGallery&&this.options.showGalleryCount?(this.element.caption?($("lightwindow_data_caption").innerHTML=this.element.caption,$("lightwindow_data_caption").setStyle({display:"block"})):$("lightwindow_data_caption").setStyle({display:"none"}),this.element.author?($("lightwindow_data_author").innerHTML=this.element.author,$("lightwindow_data_author_container").setStyle({display:"block"})):$("lightwindow_data_author_container").setStyle({display:"none"}),this.activeGallery&&this.options.showGalleryCount?($("lightwindow_data_gallery_current").innerHTML=this.galleryLocation.current,$("lightwindow_data_gallery_total").innerHTML=this.galleryLocation.total,$("lightwindow_data_gallery_container").setStyle({display:"block"})):$("lightwindow_data_gallery_container").setStyle({display:"none"}),$("lightwindow_data_slide_inner").setStyle({width:this.resizeTo.width+"px",height:"auto",visibility:"visible",display:"block"}),$("lightwindow_data_slide").setStyle({height:$("lightwindow_data_slide").getHeight()+"px",width:"1px",overflow:"hidden",display:"block"})):($("lightwindow_data_slide").setStyle({display:"none",width:"auto"}),$("lightwindow_data_slide_inner").setStyle({display:"none",visibility:"hidden",width:this.resizeTo.width+"px",height:"0px"})),$("lightwindow_title_bar_title").innerHTML="null"!=this.element.title?this.element.title:"";var i={height:$("lightwindow_container").getHeight(),width:$("lightwindow_container").getWidth()};$("lightwindow_container").setStyle({height:"auto",width:$("lightwindow_container").getWidth()+this.options.contentOffset.width-(this.windowActive?this.options.contentOffset.width:0)+"px"});var t={height:$("lightwindow_container").getHeight(),width:$("lightwindow_container").getWidth()};this.containerChange={height:i.height-t.height,width:i.width-t.width},this.dimensions.container={height:$("lightwindow_container").getHeight(),width:$("lightwindow_container").getWidth()},this.dimensions.cruft={height:this.dimensions.container.height-$("lightwindow_contents").getHeight()+this.options.contentOffset.height,width:this.dimensions.container.width-$("lightwindow_contents").getWidth()+this.options.contentOffset.width},this._presetWindowSize(),this._resizeWindowToFit(),this.windowActive||$("lightwindow_container").setStyle({left:-(this.dimensions.container.width/2)+"px",top:-(this.dimensions.container.height/2)+"px"}),$("lightwindow_container").setStyle({height:this.dimensions.container.height+"px",width:this.dimensions.container.width+"px"}),this._displayLightWindow("block","visible"),this._animateLightWindow()},_animateLightWindow:function(){this.options.animationHandler?this.options.animationHandler().bind(this):this._defaultAnimationHandler()},_handleNavigation:function(i){this.options.navigationHandler?this.options.navigationHandler().bind(this,i):this._defaultDisplayNavigation(i)},_handleTransition:function(){this.options.transitionHandler?this.options.transitionHandler().bind(this):this._defaultTransitionHandler()},_handleFinalWindowAnimation:function(i){this.options.finalAnimationHandler?this.options.finalAnimationHandler().bind(this,i):this._defaultfinalWindowAnimationHandler(i)},_handleGalleryAnimation:function(i){this.options.galleryAnimationHandler?this.options.galleryAnimationHandler().bind(this,i):this._defaultGalleryAnimationHandler(i)},_defaultDisplayNavigation:function(i){$("lightwindow_navigation").setStyle(i?{display:"block",height:$("lightwindow_contents").getHeight()+"px",width:"100%",marginTop:this.options.dimensions.titleHeight+"px"}:{display:"none",height:"auto",width:"auto"})
},_defaultAnimationHandler:function(){(this.element.caption||this.element.author||this.activeGallery&&this.options.showGalleryCount)&&($("lightwindow_data_slide").setStyle({display:"none",width:"auto"}),this.dimensions.dataEffects.push(new Effect.SlideDown("lightwindow_data_slide",{sync:!0}),new Effect.Appear("lightwindow_data_slide",{sync:!0,from:0,to:1}))),$("lightwindow_title_bar_inner").setStyle({height:"0px",marginTop:this.options.dimensions.titleHeight+"px"}),this.dimensions.dataEffects.push(new Effect.Morph("lightwindow_title_bar_inner",{sync:!0,style:{height:this.options.dimensions.titleHeight+"px",marginTop:"0px"}}),new Effect.Appear("lightwindow_title_bar_inner",{sync:!0,from:0,to:1})),this.options.hideGalleryTab||(this._handleGalleryAnimation(!1),0==$("lightwindow_galleries_tab_container").getHeight()&&(this.dimensions.dataEffects.push(new Effect.Morph("lightwindow_galleries_tab_container",{sync:!0,style:{height:"20px",marginTop:"0px"}})),$("lightwindow_galleries").setStyle({width:"0px"})));var i=!1,t=this.dimensions.container.width-$("lightwindow_contents").getWidth()+this.resizeTo.width+this.options.contentOffset.width;t!=$("lightwindow_container").getWidth()&&new Effect.Parallel([new Effect.Scale("lightwindow_contents",100*(this.resizeTo.width/$("lightwindow_contents").getWidth()),{scaleFrom:100*($("lightwindow_contents").getWidth()/($("lightwindow_contents").getWidth()+this.options.contentOffset.width)),sync:!0,scaleY:!1,scaleContent:!1}),new Effect.Scale("lightwindow_container",100*(t/this.dimensions.container.width),{sync:!0,scaleY:!1,scaleFromCenter:!0,scaleContent:!1})],{duration:this.duration,delay:.25,queue:{position:"end",scope:"lightwindowAnimation"}}),t=this.dimensions.container.height-$("lightwindow_contents").getHeight()+this.resizeTo.height+this.options.contentOffset.height,t!=$("lightwindow_container").getHeight()&&(new Effect.Parallel([new Effect.Scale("lightwindow_contents",100*(this.resizeTo.height/$("lightwindow_contents").getHeight()),{scaleFrom:100*($("lightwindow_contents").getHeight()/($("lightwindow_contents").getHeight()+this.options.contentOffset.height)),sync:!0,scaleX:!1,scaleContent:!1}),new Effect.Scale("lightwindow_container",100*(t/this.dimensions.container.height),{sync:!0,scaleX:!1,scaleFromCenter:!0,scaleContent:!1})],{duration:this.duration,afterFinish:function(){this.dimensions.dataEffects.length>0&&(this.options.hideGalleryTab||$("lightwindow_galleries").setStyle({width:this.resizeTo.width+"px"}),new Effect.Parallel(this.dimensions.dataEffects,{duration:this.duration,afterFinish:function(){this._finishWindow()}.bind(this),queue:{position:"end",scope:"lightwindowAnimation"}}))}.bind(this),queue:{position:"end",scope:"lightwindowAnimation"}}),i=!0),!i&&this.dimensions.dataEffects.length>0&&new Effect.Parallel(this.dimensions.dataEffects,{duration:this.duration,beforeStart:function(){this.options.hideGalleryTab||$("lightwindow_galleries").setStyle({width:this.resizeTo.width+"px"}),(0!=this.containerChange.height||0!=this.containerChange.width)&&new Effect.MoveBy("lightwindow_container",this.containerChange.height,this.containerChange.width,{transition:Effect.Transitions.sinoidal})}.bind(this),afterFinish:function(){this._finishWindow()}.bind(this),queue:{position:"end",scope:"lightwindowAnimation"}})},_defaultfinalWindowAnimationHandler:function(){"media"==this.windowType||this._getParameter("lightwindow_loading_animation")?(Element.hide("lightwindow_loading"),this._handleNavigation(this.activeGallery),this._setStatus(!1)):Effect.Fade("lightwindow_loading",{duration:.75,delay:1,afterFinish:function(){"image"!=this.windowType&&"media"!=this.windowType&&"external"!=this.windowType&&$("lightwindow_contents").setStyle({overflow:"auto"}),this._handleNavigation(this.activeGallery),this._defaultGalleryAnimationHandler(),this._setStatus(!1)}.bind(this),queue:{position:"end",scope:"lightwindowAnimation"}})},_defaultGalleryAnimationHandler:function(i){if(!this.activeGallery)return $("lightwindow_galleries").setStyle({display:"none"}),$("lightwindow_galleries_tab_container").setStyle({height:"0px",marginTop:"20px"}),$("lightwindow_galleries_list").setStyle({height:"0px"}),!1;if($("lightwindow_galleries").setStyle({display:"block",marginBottom:$("lightwindow_data_slide").getHeight()+this.options.contentOffset.height/2+"px"}),$("lightwindow_navigation").setStyle({height:$("lightwindow_contents").getHeight()-20+"px"}),i){if(0==$("lightwindow_galleries_list").getHeight()){var t=.8*$("lightwindow_contents").getHeight();$("lightwindow_galleries_tab_span").className="down"}else{var t=0;$("lightwindow_galleries_tab_span").className="up"}new Effect.Morph("lightwindow_galleries_list",{duration:this.duration,transition:Effect.Transitions.sinoidal,style:{height:t+"px"},beforeStart:function(){$("lightwindow_galleries_list").setStyle({overflow:"hidden"})},afterFinish:function(){$("lightwindow_galleries_list").setStyle({overflow:"auto"})},queue:{position:"end",scope:"lightwindowAnimation"}})}},_defaultTransitionHandler:function(){this.dimensions.dataEffects=[],"none"!=$("lightwindow_data_slide").getStyle("display")&&this.dimensions.dataEffects.push(new Effect.SlideUp("lightwindow_data_slide",{sync:!0}),new Effect.Fade("lightwindow_data_slide",{sync:!0,from:1,to:0})),this.options.hideGalleryTab||(0==$("lightwindow_galleries").getHeight()||this.options.hideGalleryTab||this.dimensions.dataEffects.push(new Effect.Morph("lightwindow_galleries_tab_container",{sync:!0,style:{height:"0px",marginTop:"20px"}})),0!=$("lightwindow_galleries_list").getHeight()&&($("lightwindow_galleries_tab_span").className="up",this.dimensions.dataEffects.push(new Effect.Morph("lightwindow_galleries_list",{sync:!0,style:{height:"0px"},transition:Effect.Transitions.sinoidal,beforeStart:function(){$("lightwindow_galleries_list").setStyle({overflow:"hidden"})},afterFinish:function(){$("lightwindow_galleries_list").setStyle({overflow:"auto"})}})))),this.dimensions.dataEffects.push(new Effect.Morph("lightwindow_title_bar_inner",{sync:!0,style:{height:"0px",marginTop:this.options.dimensions.titleHeight+"px"}}),new Effect.Fade("lightwindow_title_bar_inner",{sync:!0,from:1,to:0})),new Effect.Parallel(this.dimensions.dataEffects,{duration:this.duration,afterFinish:function(){this._loadWindow()}.bind(this),queue:{position:"end",scope:"lightwindowAnimation"}})},_defaultFormHandler:function(i){var t=Event.element(i).parentNode,e=Form.serialize(this._getParameter("lightwindow_form",t.getAttribute("params")));if("post"==this.options.formMethod){new Ajax.Request(t.href,{method:"post",postBody:e,onComplete:this.openWindow.bind(this,t)})}else if("get"==this.options.formMethod){new Ajax.Request(t.href,{method:"get",parameters:e,onComplete:this.openWindow.bind(this,t)})}},_finishWindow:function(){if("external"==this.windowType)$(this.iframeNome).setAttribute("src",this.element.href),this._handleFinalWindowAnimation(1);else if("media"==this.windowType){var i=document.createElement("object");if(i.setAttribute("classid",this.options.classids[this._fileExtension(this.contentToFetch)]),i.setAttribute("codebase",this.options.codebases[this._fileExtension(this.contentToFetch)]),i.setAttribute("id","lightwindow_media_primary"),i.setAttribute("name","lightwindow_media_primary"),i.setAttribute("width",this.resizeTo.width),i.setAttribute("height",this.resizeTo.height),i=this._addParamToObject("movie",this.contentToFetch,i),i=this._addParamToObject("src",this.contentToFetch,i),i=this._addParamToObject("controller","true",i),i=this._addParamToObject("wmode","transparent",i),i=this._addParamToObject("cache","false",i),i=this._addParamToObject("quality","high",i),!Prototype.Browser.IE){var t=document.createElement("object");t.setAttribute("type",this.options.mimeTypes[this._fileExtension(this.contentToFetch)]),t.setAttribute("data",this.contentToFetch),t.setAttribute("id","lightwindow_media_secondary"),t.setAttribute("name","lightwindow_media_secondary"),t.setAttribute("width",this.resizeTo.width),t.setAttribute("height",this.resizeTo.height),t=this._addParamToObject("controller","true",t),t=this._addParamToObject("wmode","transparent",t),t=this._addParamToObject("cache","false",t),t=this._addParamToObject("quality","high",t),i.appendChild(t)}this._getParameter("lightwindow_iframe_embed")?(this._appendIframe("no"),this._writeToIframe(this._convertToMarkup(i,"object"))):this._appendObject(i,"object",$("lightwindow_contents")),this._handleFinalWindowAnimation(0)}else this._handleFinalWindowAnimation(0);this._setupActions()}},Event.observe(window,"load",lightwindowInit,!1);var myLightWindow=null;